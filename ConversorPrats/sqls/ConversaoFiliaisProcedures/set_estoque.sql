SET TERM ^ ;

CREATE OR ALTER procedure set_estoque_conv (
    filial integer,
    produto integer,
    barras varchar(18),
    tipoitem integer,
    customedio numeric(15,6),
    custotabela numeric(15,6),
    venda varchar(1),
    exportar varchar(1))
as
declare variable codigoproduto integer;
BEGIN
    CODIGOPRODUTO = NULL;
   /* IF (:BARRAS = '7898953148015') THEN CODIGOPRODUTO = 1;
    IF (:BARRAS = '7898953148169') THEN CODIGOPRODUTO = 1279;
    IF (:BARRAS = '7898953148176') THEN CODIGOPRODUTO = 1384;
    IF (:BARRAS = '7898953148213') THEN CODIGOPRODUTO = 1438;
    IF (:BARRAS = '7898953148220') THEN CODIGOPRODUTO = 1557;
    IF (:BARRAS = '7898953148237') THEN CODIGOPRODUTO = 1558;
    IF (:BARRAS = '7898953148268') THEN CODIGOPRODUTO = 1980;
    IF (:BARRAS = '7898953148275') THEN CODIGOPRODUTO = 1981;
    IF (:BARRAS = '7898953148428') THEN CODIGOPRODUTO = 4128;
    IF (:BARRAS = '7898953148435') THEN CODIGOPRODUTO = 4129;
    IF (:BARRAS = '7898953148541') THEN CODIGOPRODUTO = 9421; */

    SELECT PRODUTODEPARA.PARA
    FROM PRODUTODEPARA
    WHERE PRODUTODEPARA.DE = :PRODUTO
    AND PRODUTODEPARA.FILIAL = :FILIAL
    INTO :CODIGOPRODUTO;

    IF (:CODIGOPRODUTO IS NULL) THEN
        EXCEPTION EXCEPTION_VALORCAMPO'PRODUTO';

    UPDATE ESTOQUE SET
        ESTOQUE.VALORMEDIO = :CUSTOMEDIO,
        ESTOQUE.VALORCUSTO = :CUSTOTABELA,
        ESTOQUE.VALORCUSTOTABELA = :CUSTOTABELA,
        ESTOQUE.EXPORTAR = :EXPORTAR,
        ESTOQUE.VENDA = :VENDA
    WHERE ESTOQUE.FILIAL = :FILIAL
    AND ESTOQUE.PRODUTO = :CODIGOPRODUTO;
END^

SET TERM ; ^

